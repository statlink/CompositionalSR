moran.adcor <- function(y, a, W, R = 999) {
  if ( length(a) == 1 ) {
    ya <- Compositional::alfa(y, a)$aff
    res <- estats::dcov.test(ya, W %*% ya, R = R)[2]
  } else {
    if ( min(y) == 0 )  a <- a[ a > 0 ]
    len <- length(a)
    res <- numeric(len)
    for ( i in 1:len )  {
      ya <- Compositional::alfa(y, a[i])$aff
      res[i] <- estats::dcov.test(ya, W %*% ya, R = R)[2]
    }
    names(res) <- paste(alpha=, a, sep = "")
  }
  res
}
